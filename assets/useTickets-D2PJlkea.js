import{u as c,b as u,c as a}from"./vendor-query-30WTYxUa.js";import{t as d}from"./queryKeys-D-dtdCA2.js";const g=()=>{try{const e=localStorage.getItem("matter-management-user");if(e)return JSON.parse(e).id}catch{}return"user-1"},s=[{id:"ticket-1",title:"Fix login bug",status:"open",priority:"high",createdAt:"2024-01-15T10:00:00Z",description:"Users cannot log in with their credentials. This is a critical issue affecting multiple users.",reporterId:"user-1",assigneeId:"user-2",dueDate:new Date(Date.now()+2*24*60*60*1e3).toISOString()},{id:"ticket-2",title:"Update dashboard UI",status:"in-progress",priority:"medium",createdAt:"2024-01-14T14:30:00Z",description:"Redesign the dashboard to match new brand guidelines. Include new color scheme and typography.",reporterId:"user-2",assigneeId:"user-1",dueDate:new Date(Date.now()+7*24*60*60*1e3).toISOString()},{id:"ticket-3",title:"Add dark mode",status:"closed",priority:"low",createdAt:"2024-01-10T09:15:00Z",description:"Implement dark mode theme across the application. Ensure all components support both themes.",reporterId:"user-1",assigneeId:"user-3",dueDate:new Date(Date.now()+15*24*60*60*1e3).toISOString()},{id:"ticket-4",title:"Optimize database queries",status:"open",priority:"critical",createdAt:"2024-01-12T11:20:00Z",description:"Improve performance of slow database queries. Add proper indexing and optimize joins.",reporterId:"user-3",assigneeId:"user-1",dueDate:new Date(Date.now()+1*24*60*60*1e3).toISOString()},{id:"ticket-5",title:"Implement user settings page",status:"open",priority:"medium",createdAt:"2024-01-16T08:00:00Z",description:"Create a user settings page for profile management and preferences.",reporterId:"user-2",assigneeId:"user-4",dueDate:new Date(Date.now()+14*24*60*60*1e3).toISOString()}];let f=6;const o=e=>new Promise(t=>setTimeout(t,e)),w=async e=>{await o(300);let t=[...s];if(e!=null&&e.search){const i=e.search.toLowerCase();t=t.filter(r=>{var n;return r.title.toLowerCase().includes(i)||((n=r.description)==null?void 0:n.toLowerCase().includes(i))})}if(e!=null&&e.status&&e.status!=="all"&&(t=t.filter(i=>i.status===e.status)),e!=null&&e.priority&&e.priority!=="all"&&(t=t.filter(i=>i.priority===e.priority)),e!=null&&e.assigneeId&&(t=t.filter(i=>i.assigneeId===e.assigneeId)),e!=null&&e.dueThisWeek){const i=new Date,r=new Date(i);r.setDate(i.getDate()-i.getDay()),r.setHours(0,0,0,0);const n=new Date(r);n.setDate(r.getDate()+6),n.setHours(23,59,59,999),t=t.filter(l=>{if(!l.dueDate)return!1;const y=new Date(l.dueDate);return y>=r&&y<=n})}if((e==null?void 0:e.sortBy)==="date")t.sort((i,r)=>new Date(r.createdAt).getTime()-new Date(i.createdAt).getTime());else if((e==null?void 0:e.sortBy)==="title")t.sort((i,r)=>i.title.localeCompare(r.title));else if((e==null?void 0:e.sortBy)==="priority"){const i={critical:0,high:1,medium:2,low:3};t.sort((r,n)=>i[r.priority]-i[n.priority])}else(e==null?void 0:e.sortBy)==="dueDate"&&t.sort((i,r)=>i.dueDate?r.dueDate?new Date(i.dueDate).getTime()-new Date(r.dueDate).getTime():-1:1);return t},D=async e=>{await o(300);const t={id:`ticket-${f++}`,title:e.title,description:e.description||"",status:e.status||"open",priority:e.priority||"medium",reporterId:g(),assigneeId:e.assigneeId,dueDate:e.dueDate,createdAt:new Date().toISOString()};return s.push(t),t},h=async e=>{await o(300);const t=s.findIndex(r=>r.id===e.id);if(t===-1)throw new Error("Ticket not found");const i={...s[t],...e.title!==void 0&&{title:e.title},...e.description!==void 0&&{description:e.description},...e.status!==void 0&&{status:e.status},...e.priority!==void 0&&{priority:e.priority},...e.assigneeId!==void 0&&{assigneeId:e.assigneeId},...e.dueDate!==void 0&&{dueDate:e.dueDate},updatedAt:new Date().toISOString()};return s[t]=i,i},I=async e=>{await o(200);const t=s.findIndex(i=>i.id===e);if(t===-1)throw new Error("Ticket not found");s.splice(t,1)},k=async()=>{await o(300);const e=g();return{assigned:s.filter(t=>t.assigneeId===e),reported:s.filter(t=>t.reporterId===e)}},T=async()=>(await o(200),{total:s.length,open:s.filter(e=>e.status==="open").length,inProgress:s.filter(e=>e.status==="in-progress").length,closed:s.filter(e=>e.status==="closed").length,byPriority:{critical:s.filter(e=>e.priority==="critical").length,high:s.filter(e=>e.priority==="high").length,medium:s.filter(e=>e.priority==="medium").length,low:s.filter(e=>e.priority==="low").length}}),v=e=>c({queryKey:d.list(e),queryFn:()=>w(e),staleTime:3e4}),p=()=>c({queryKey:["tickets","my"],queryFn:k,staleTime:3e4}),K=()=>c({queryKey:["tickets","stats"],queryFn:T,staleTime:6e4}),O=()=>{const e=u();return a({mutationFn:t=>D(t),onSuccess:()=>{e.invalidateQueries({queryKey:d.lists()}),e.invalidateQueries({queryKey:["tickets","my"]}),e.invalidateQueries({queryKey:["tickets","stats"]})}})},Q=()=>{const e=u();return a({mutationFn:t=>h(t),onSuccess:t=>{e.invalidateQueries({queryKey:d.lists()}),e.setQueryData(d.detail(t.id),t),e.invalidateQueries({queryKey:["tickets","my"]}),e.invalidateQueries({queryKey:["tickets","stats"]})}})},A=()=>{const e=u();return a({mutationFn:t=>I(t),onSuccess:()=>{e.invalidateQueries({queryKey:d.lists()}),e.invalidateQueries({queryKey:["tickets","my"]}),e.invalidateQueries({queryKey:["tickets","stats"]})}})};export{p as a,v as b,Q as c,A as d,O as e,K as u};
