import{j as e}from"./vendor-query-30WTYxUa.js";import{r as a}from"./vendor-react-3BJtw-ek.js";import{T as t,u as $}from"./index-qdssDWYQ.js";import{a as L,c as k,d as P}from"./useTickets-l-PqA1f4.js";import{i as R,a as M,B as u,A as w,f as B,M as F,T as G,C as v}from"./Badge-D2-mizKm.js";import"./queryKeys-D-dtdCA2.js";import"./useUsers-vdCakwpb.js";const W=({ticket:s,activeTab:n,onEdit:d,onDelete:i})=>e.jsxs("tr",{children:[e.jsxs("td",{className:"ticket-id-cell",children:["#",s.id]}),e.jsxs("td",{className:"ticket-title-cell",children:[s.title,R(s.dueDate)&&!M(s.dueDate)&&e.jsx(u,{type:"due",value:"Due this week"}),M(s.dueDate)&&e.jsx(u,{type:"due",value:"Overdue"})]}),e.jsx("td",{children:e.jsx(u,{type:"status",value:s.status})}),e.jsx("td",{children:e.jsx(u,{type:"priority",value:s.priority})}),e.jsx("td",{children:e.jsx("div",{onClick:l=>l.stopPropagation(),children:e.jsx(w,{ticketId:s.id,currentAssigneeId:n==="assigned"?s.reporterId:s.assigneeId,readonly:n==="assigned"})})}),e.jsx("td",{children:s.dueDate?B(s.dueDate):"-"}),e.jsx("td",{children:e.jsxs("div",{className:"table-actions",children:[e.jsx("button",{className:"action-btn",onClick:()=>d(s),children:"âœï¸"}),e.jsx("button",{className:"action-btn delete",onClick:()=>i(s.id),children:"ðŸ—‘ï¸"})]})})]}),Y=({tickets:s,activeTab:n,onEdit:d,onDelete:i})=>!s||s.length===0?e.jsx("div",{className:"empty-state",children:e.jsxs("p",{children:["No ",t.items," found"]})}):e.jsx("div",{className:"tickets-table-container",children:e.jsxs("table",{className:"tickets-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Priority"}),e.jsx("th",{children:n==="assigned"?"Reporter":"Assignee"}),e.jsx("th",{children:"Due Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:s.map(l=>e.jsx(W,{ticket:l,activeTab:n,onEdit:d,onDelete:i},l.id))})]})}),X=()=>{$();const{data:s,isLoading:n,error:d}=L(),i=k(),l=P(),[o,m]=a.useState("assigned"),[C,h]=a.useState(!1),[N,j]=a.useState(!1),[g,f]=a.useState(null),[c,p]=a.useState(null),[y,x]=a.useState(!1),[D,b]=a.useState(null),I=r=>{p(r),h(!0)},O=r=>{f(r),j(!0)},S=()=>{g&&(l.mutate(g),f(null))},E=r=>{c&&(b(r),x(!0))},A=()=>{c&&D&&i.mutate({id:c.id,...D},{onSuccess:()=>{h(!1),p(null),x(!1),b(null)}})},T=()=>{h(!1),p(null)};if(n)return e.jsxs("div",{className:"loading",children:["Loading your ",t.items,"..."]});if(d)return e.jsxs("div",{className:"error-message",children:["Error loading your ",t.items]});const U=o==="assigned"?s==null?void 0:s.assigned:s==null?void 0:s.reported;return e.jsxs("div",{className:"my-tickets-page",children:[e.jsx("div",{className:"page-header",children:e.jsxs("h1",{children:["My ",t.ITEMS]})}),e.jsxs("div",{className:"tabs",children:[e.jsxs("button",{className:`tab ${o==="assigned"?"active":""}`,onClick:()=>m("assigned"),children:["Assigned to Me (",(s==null?void 0:s.assigned.length)||0,")"]}),e.jsxs("button",{className:`tab ${o==="reported"?"active":""}`,onClick:()=>m("reported"),children:["Reported by Me (",(s==null?void 0:s.reported.length)||0,")"]})]}),e.jsx(Y,{tickets:U,activeTab:o,onEdit:I,onDelete:O}),e.jsx(F,{isOpen:C,onClose:T,title:`Edit ${t.ITEM}`,children:e.jsx(G,{ticket:c,onSubmit:E,onCancel:T,isLoading:i.isPending})}),e.jsx(v,{isOpen:y,onClose:()=>x(!1),onConfirm:A,title:`Update ${t.ITEM}`,message:`Are you sure you want to update this ${t.item}?`,confirmLabel:"Update"}),e.jsx(v,{isOpen:N,onClose:()=>j(!1),onConfirm:S,title:`Delete ${t.ITEM}`,message:`Are you sure you want to delete this ${t.item}?
This action cannot be undone.`,confirmLabel:"Delete",isDanger:!0})]})};export{X as default};
